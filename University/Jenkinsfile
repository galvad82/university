pipeline {
    agent any
    tools { 
		maven 'mvn' 
		jdk 'jdk11' 
	}
    stages {
        stage('Scan-package') { 
			steps {
				withSonarQubeEnv(credentialsId: 'jenkins-sonar-token', installationName:'sonar'){
					sh 'cd ./University; mvn clean package sonar:sonar -Dstyle.color=never; docker build -t university . -f ./dockerfiles/Dockerfile'
				}
            }
		}
		stage('docker-compose') {
           steps {
              sh "cd ./dockerfiles; /usr/bin/docker-compose up -d -f docker-compose.yml"
           }
       }
    }
}
